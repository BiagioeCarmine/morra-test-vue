{"version":3,"sources":["webpack:///./src/views/Play.vue","webpack:///./src/views/Play.vue?7980"],"names":["over","scoreUser","scoreOtherPlayer","waiting","secondiRimanenti","secondiRimanenti2","notFirstRound","handOtherPlayer","predictionOtherPlayer","hand","type","value","prediction","name","data","q","query","match","remainingTime","nextRoundTime","undefined","token","id","weAreUser1","active","created","localStorage","getItem","console","log","window","location","href","backend","verifyUser","res","this","getMatch","userid1","userid2","alert","setInterval","calculateRemainingSeconds","calculateRemainingSeconds2","setTimeout","beforeRouteLeave","methods","Math","floor","Date","getTime","now","nextResultsTime","confirmed","start_time","first_round_results","msToNextRound","setMove","getMove","cur_points1","cur_points2","hand2","prediction2","hand1","prediction1","next_round_start","next_round_results","render"],"mappings":"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","file":"js/chunk-2d0ddbee.42f36e8f.js","sourcesContent":["<template>\n  <div v-if=\"over\">\n    Partita finita\n    <div v-if=\"scoreUser == 12\">\n      <h1>Hai vinto, complimenti, dona del danaro a carmine@carminezacc.com su PayPal e vincerai anche altre partite</h1>\n    </div>\n    <div v-if=\"scoreOtherPlayer == 12\">\n      <h1>Hai perso, dona del danaro a carmine@carminezacc.com su PayPal e vedi che vincerai almeno una partita prima o poi</h1>\n    </div>\n  </div>\n  <div v-else-if=\"waiting\">\n    In attesa...\n  </div>\n  <div v-else>\n    <h1>Gioca la partita</h1>\n    <h2>{{ secondiRimanenti }} secondi rimanenti per scegliere la mossa</h2>\n    <h2>{{ secondiRimanenti2 }} secondi rimanenti per saper eil risultato del round</h2>\n    <h2> {{ scoreUser }}-{{ scoreOtherPlayer }}</h2>\n    <h2 v-if=\"notFirstRound\"> Nell'ultimo round l'altro giocatore ha buttato {{ handOtherPlayer }} e ha urlato {{ predictionOtherPlayer }}!!</h2>\n    <h2>Mano, scelta {{ hand }}</h2>\n    <input type=\"radio\" value=1 v-model=\"hand\" />1<br />\n    <input type=\"radio\" value=2 v-model=\"hand\" />2<br />\n    <input type=\"radio\" value=3 v-model=\"hand\" />3<br />\n    <input type=\"radio\" value=4 v-model=\"hand\" />4<br />\n    <input type=\"radio\" value=5 v-model=\"hand\" />5<br />\n    <h2>Previsione, scelta {{ prediction }}</h2>\n    <input type=\"radio\" value=2 v-model=\"prediction\" />2<br />\n    <input type=\"radio\" value=3 v-model=\"prediction\" />3<br />\n    <input type=\"radio\" value=4 v-model=\"prediction\" />4<br />\n    <input type=\"radio\" value=5 v-model=\"prediction\" />5<br />\n    <input type=\"radio\" value=6 v-model=\"prediction\" />6<br />\n    <input type=\"radio\" value=7 v-model=\"prediction\" />7<br />\n    <input type=\"radio\" value=8 v-model=\"prediction\" />8<br />\n    <input type=\"radio\" value=9 v-model=\"prediction\" />9<br />\n    <input type=\"radio\" value=10 v-model=\"prediction\" />10<br />\n  </div>\n\n</template>\n<script>\nimport backend from \"../backend\"\nimport {useRoute} from 'vue-router';\n\nexport default {\n  name: 'Play',\n  data: () => {\n      return {\n        q: useRoute().query.match,\n        scoreUser: 0,\n        scoreOtherPlayer: 0,\n        waiting: true,\n        hand: 1,\n        match: {},\n        prediction: 2,\n        remainingTime: 5,\n        nextRoundTime: null,\n        secondiRimanenti: 0,\n        secondiRimanenti2: 0,\n        handOtherPlayer: undefined,\n        predictionOtherPlayer: undefined,\n        token: \"\",\n        id: 0,\n        notFirstRound: false,\n        weAreUser1: false,\n        active: true,\n        over: false\n      }\n  },\n  created: async function() {\n    let token = localStorage.getItem(\"token\");\n    if(token == null) {\n      console.log(\"andiamo al login per token mancante\");\n      window.location.href = \"/#/login\";\n      return;\n    }\n\n    try {\n      let res = await backend.verifyUser(token);\n      this.id = res.data.id;\n    } catch(e) {\n      console.log(\"andiamo al login per token non valido\");\n      window.location.href = \"/#/login\";\n      return;\n    }\n    this.token = token;\n    await this.getMatch();\n    if(this.match.userid1 == this.id) {\n      this.weAreUser1 = true;\n    } else if (this.match.userid2 != this.id) {\n      alert(\"con questa partita non c'entri niente\");\n      window.location.href = \"/\";\n    }\n\n    setInterval(this.calculateRemainingSeconds, 100);\n    setInterval(this.calculateRemainingSeconds2, 100);\n    setTimeout(() => {\n      if(this.waiting)\n        window.location.href = \"/\";\n    }, 15000)\n  },\n  beforeRouteLeave: function() {\n    this.active = false;\n  },\n  methods: {\n      async calculateRemainingSeconds() {\n        this.secondiRimanenti = Math.floor((new Date(this.nextRoundTime).getTime()-Date.now())/1000)\n      },\n      async calculateRemainingSeconds2() {\n        this.secondiRimanenti2 = Math.floor((new Date(this.nextResultsTime).getTime()-Date.now())/1000)\n      },\n      async getMatch() {\n        this.match = await backend.getMatch(this.q);\n        if(this.waiting && !this.match.confirmed) {\n          setTimeout(this.getMatch, 800) // aspettiamo che la partita sia confermata\n        }\n        if(this.match.confirmed) {\n          this.waiting = false;\n          this.nextRoundTime = this.match.start_time;\n          this.nextResultsTime = this.match.first_round_results;\n          let msToNextRound = new Date(this.match.start_time).getTime()-Date.now();\n          setTimeout(this.setMove, msToNextRound);\n          this.remainingTime = Math.floor(msToNextRound/1000);\n        }\n      },\n      async setMove() {\n        if(!this.active) return;\n        try {\n            let res = await backend.setMove(this.hand, this.prediction, this.match.id, this.token);\n            let msToNextRound = new Date(this.nextResultsTime).getTime()-Date.now();\n            setTimeout(this.getMove, msToNextRound);\n        } catch(e){ alert(`Si è verificato l'errore\\n${e}`);}\n      },\n      async getMove() {\n        if(!this.active) return;\n        this.notFirstRound = true;\n        try {\n            let res = await backend.getMove(this.match.id);\n            console.log(res.data);\n            if(this.weAreUser1) {\n              this.scoreUser = res.data.cur_points1;\n              this.scoreOtherPlayer = res.data.cur_points2;\n              this.handOtherPlayer = res.data.hand2;\n              this.predictionOtherPlayer = res.data.prediction2;\n            } else {\n              this.scoreUser = res.data.cur_points2;\n              this.scoreOtherPlayer = res.data.cur_points1;\n              this.handOtherPlayer = res.data.hand1;\n              this.predictionOtherPlayer = res.data.prediction1;\n            }\n            if(res.data.next_round_start == \"over\") {\n              this.over = true;\n              return;\n            }\n            let msToNextRound = new Date(res.data.next_round_start).getTime()-Date.now();\n            this.nextRoundTime = res.data.next_round_start;\n            this.nextResultsTime = res.data.next_round_results;\n            setTimeout(this.setMove, msToNextRound);\n        } catch(e){ alert(`Si è verificato l'errore\\n${e}`);}\n      }\n  }\n}\n</script>\n","import { render } from \"./Play.vue?vue&type=template&id=3220a0ce\"\nimport script from \"./Play.vue?vue&type=script&lang=js\"\nexport * from \"./Play.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}